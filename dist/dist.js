"use strict";var bootState={preload:function(){game.load.image("progressBar","assets/progressBar.png"),game.load.script("webfont","//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js")},create:function(){!1===game.device.desktop&&(document.body.style.backgroundColor="#313131"),game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,game.scale.windowConstraints.bottom="visual",game.scale.pageAlignHorizontally=!1,game.scale.pageAlignVertically=!1,game.stage.backgroundColor="#313131",game.physics.startSystem(Phaser.Physics.ARCADE),game.state.start("load")}},loadState={preload:function(){var t=game.add.sprite(game.world.centerX,game.world.centerY,"progressBar");t.anchor.setTo(.5,.5),game.load.setPreloadSprite(t),game.load.spritesheet("achille","assets/achille.png",40,36,12),game.load.spritesheet("ernest","assets/ernest.png",40,36,12),game.load.spritesheet("coin","assets/coin.png",32,32,4),game.load.spritesheet("mute","assets/muteButton.png",28,22),game.load.spritesheet("enemy","assets/enemy.png",32,32,8),game.load.spritesheet("enemy2","assets/enemy2.png",40,26,8),game.load.spritesheet("boss","assets/boss.png",56,74,5),game.load.spritesheet("health","assets/coeur.png",156,24,6),game.load.spritesheet("healthBoss","assets/health-boss.png",80,16,6),game.load.image("background","assets/background.jpg"),game.load.image("backgroundscroll","assets/backgroundscroll.png"),game.load.image("potion","assets/red-potion.png"),game.load.image("pixel","assets/particule.png"),game.load.image("tileset","assets/tileset.png"),game.load.image("minion","assets/minion.png"),game.load.image("minion2","assets/minion2.png"),game.load.image("explosion","assets/explosion.png"),game.load.image("achilleimg","assets/achilleimg.png"),game.load.image("ernestimg","assets/ernestimg.png"),game.load.image("arrows","assets/arrowKeys.png"),game.load.image("wallH","assets/plateforme.png"),game.load.image("missile","assets/missile.png"),game.load.image("healthBonus","assets/healthBonus.png"),game.load.image("trophy","assets/trophy.png"),game.load.image("jumpButton","assets/jumpButton.png"),game.load.image("rightButton","assets/rightButton.png"),game.load.image("leftButton","assets/leftButton.png"),game.load.image("dialogue","assets/dialogue.png"),game.load.tilemap("1","assets/map1.json",null,Phaser.Tilemap.TILED_JSON),game.load.tilemap("2","assets/map2.json",null,Phaser.Tilemap.TILED_JSON),game.load.tilemap("3","assets/map3.json",null,Phaser.Tilemap.TILED_JSON),game.load.tilemap("4","assets/map4.json",null,Phaser.Tilemap.TILED_JSON),game.load.audio("jump",["assets/jump.ogg","assets/jump.mp3"]),game.load.audio("coin",["assets/coin.ogg","assets/coin.mp3"]),game.load.audio("hurtSound",["assets/hurt.ogg","assets/hurt.mp3"]),game.load.audio("dead",["assets/dead.ogg","assets/dead.mp3"]),game.load.audio("castelvania",["assets/castelvania.mp3","assets/castelvania.ogg"]),game.load.audio("potion",["assets/powerup.ogg","assets/powerup.mp3"]),game.load.audio("boom",["assets/laser.ogg","assets/laser.mp3"]),game.load.audio("bossDieSound",["assets/bossDie.ogg","assets/bossDie.mp3"]),game.load.audio("bossHurtSound",["assets/bossHurt.ogg","assets/bossHurt.mp3"]),game.load.audio("enemyDieSound",["assets/enemyDie.ogg","assets/enemyDie.mp3"]),game.load.audio("explosion",["assets/explosion.ogg","assets/explosion.mp3"]),game.load.audio("fall",["assets/fall.ogg","assets/fall.mp3"]),game.load.audio("trophy",["assets/trophy.ogg","assets/trophy.mp3"]),game.load.text("level1","assets/data/level1.json"),game.load.text("level2","assets/data/level2.json"),game.load.text("level3","assets/data/level3.json"),game.load.text("level4","assets/data/level4.json"),game.load.text("easy","assets/data/easy.json"),game.load.text("casual","assets/data/casual.json"),game.load.text("hard","assets/data/hard.json"),game.load.text("trophy","assets/data/trophy.json")},create:function(){game.conf.enemyKillCounter=0,game.conf.easyEnding=!1,game.conf.casualEnding=!1,game.conf.hardEnding=!1,game.state.start("menu")}},menuState={create:function(){game.stage.backgroundColor="#313131",this.music=game.add.audio("castelvania",1,!0),this.minion=game.add.sprite(400,game.world.centerY,"minion"),this.minion.anchor.set(.5),this.explosion=game.add.sprite(400,game.world.centerY,"explosion"),this.explosion.anchor.set(.5),this.explosion.scale.setTo(0),this.explosionSound=game.add.audio("explosion"),this.explosionSound.volume=.5,this.random=game.add.sprite(400,-70,"achilleimg"),this.random.anchor.set(.5),this.fall=game.add.audio("fall"),this.fall.volume=.3,this.fall.play(),this.nameLabel=game.add.text(400,-50,"Random Guy Adventures",{font:fontxl,fill:textColor}),this.nameLabel.anchor.setTo(.5,.5),this.startButton=game.add.text(150,720,"Démarrer",{font:fontxl,fill:textColor}),this.startButton.anchor.set(.5),this.startButton.alpha=.5,this.startButton.inputEnabled=!0,this.helpButton=game.add.text(400,720,"Tutorial",{font:fontxl,fill:textColor}),this.helpButton.anchor.set(.5),this.helpButton.alpha=.5,this.helpButton.inputEnabled=!0,this.trophyButton=game.add.text(650,720,"Trophées",{font:fontxl,fill:textColor}),this.trophyButton.anchor.set(.5),this.trophyButton.alpha=.5,this.trophyButton.inputEnabled=!0,this.arrows=game.add.sprite(900,game.world.centerY-15,"arrows"),this.arrows.anchor.set(.5),this.muteButton=game.add.button(20,20,"mute",this.toggleSound,this),this.muteButton.input.useHandCursor=!0,game.sound.mute&&(this.muteButton.frame=1),game.input.onDown.add(this.menuChoice,this),game.time.events.add(500,this.titleRandom,this),game.time.events.add(800,this.titleExplosion,this),game.time.events.add(800,this.titleMinion,this),game.time.events.add(1800,this.titleText,this),game.time.events.add(1800,this.titleStart,this),game.time.events.add(1800,this.titleControls,this)},update:function(){this.startButton.input.pointerOver()?this.startButton.alpha=1:this.helpButton.input.pointerOver()?this.helpButton.alpha=1:this.trophyButton.input.pointerOver()?this.trophyButton.alpha=1:(this.startButton.alpha=.5,this.helpButton.alpha=.5,this.trophyButton.alpha=.5)},titleRandom:function(){game.add.tween(this.random).to({y:game.world.centerY},1e3).easing(Phaser.Easing.Bounce.Out).start()},titleText:function(){game.add.tween(this.nameLabel).to({y:100},1e3).easing(Phaser.Easing.Circular.Out).start()},titleExplosion:function(){game.add.tween(this.explosion.scale).to({x:1,y:1},500,Phaser.Easing.Bounce.Out,!0),game.add.tween(this.explosion).to({angle:-5},500).to({angle:0},500).loop().start(),this.explosionSound.play()},titleStart:function(){game.add.tween(this.startButton).to({y:game.world.centerY+200},1e3).easing(Phaser.Easing.Circular.Out).start(),game.add.tween(this.helpButton).to({y:game.world.centerY+200},1e3).easing(Phaser.Easing.Circular.Out).start(),game.add.tween(this.trophyButton).to({y:game.world.centerY+200},1e3).easing(Phaser.Easing.Circular.Out).start(),void 0===this.musicplay&&this.music.loopFull(),this.musicplay=1},titleControls:function(){game.add.tween(this.arrows).to({x:560,y:game.world.centerY-15},1e3).easing(Phaser.Easing.Circular.Out).start(),game.add.tween(this.arrows.scale).to({x:.8,y:.8},250).to({x:1,y:1},250).loop().start()},titleMinion:function(){this.minion.destroy(),this.minion=game.add.sprite(400,game.world.centerY,"minion2"),this.minion.anchor.setTo(.5,.5),game.add.tween(this.minion).to({x:200,y:game.world.centerY-100},1e3).easing(Phaser.Easing.Circular.Out).start(),game.add.tween(this.minion).to({angle:-50},1e3,Phaser.Easing.Circular.Out,!0)},transitionAnimation:function(t){game.add.tween(this.random).to({x:this.random.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.nameLabel).to({x:this.nameLabel.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.explosion).to({x:this.explosion.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.startButton).to({x:this.startButton.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.helpButton).to({x:this.helpButton.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.trophyButton).to({x:this.trophyButton.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.arrows).to({x:this.arrows.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.minion).to({x:this.minion.x-800},400,Phaser.Easing.Linear.Out,!0),"character"===t?game.time.events.add(500,this.stateCharacter,this):"help"===t?game.time.events.add(500,this.stateHelp,this):"trophy"===t&&game.time.events.add(500,this.stateTrophy,this)},stateCharacter:function(){game.state.start("character")},stateHelp:function(){game.state.start("help")},stateTrophy:function(){game.state.start("trophy")},menuChoice:function(){this.muteButton.input.pointerOver()||100!==this.nameLabel.y||(this.startButton.input.pointerOver()?this.transitionAnimation("character"):this.helpButton.input.pointerOver()?this.transitionAnimation("help"):this.trophyButton.input.pointerOver()&&this.transitionAnimation("trophy"))},toggleSound:function(){game.sound.mute=!game.sound.mute,this.muteButton.frame=game.sound.mute?1:0},restartGame:function(){this.castelvania.stop()}},trophyState={init:function(){this.trophyData=JSON.parse(this.game.cache.getText("trophy"))},create:function(){game.stage.backgroundColor="#313131",this.title=game.add.text(1100,100,"Trophées",{font:fontxl,fill:textColor}),game.add.tween(this.title).to({x:400},400,Phaser.Easing.Linear.Out,!0),this.title.anchor.set(.5),this.returnButton=game.add.text(1100,game.world.centerY+240,"Retour",{font:fontxl,fill:textColor}),game.add.tween(this.returnButton).to({x:400},400,Phaser.Easing.Linear.Out,!0),this.returnButton.anchor.set(.5),this.returnButton.alpha=.5,this.returnButton.inputEnabled=!0,this.muteButton=game.add.button(20,20,"mute",this.toggleSound,this),this.muteButton.input.useHandCursor=!0,game.sound.mute&&(this.muteButton.frame=1),this.trophyLocked=[],this.trophyLockedText=[],this.trophyCounter=0;for(var t=0;t<3;t++)for(var e=0;e<5;e++)this.trophyLocked[this.trophyCounter]=game.add.sprite(840+200*t,200+60*e,"trophy"),this.trophyLocked[this.trophyCounter].anchor.setTo(.5,.5),this.trophyLocked[this.trophyCounter].scale.setTo(.5,.5),this.trophyLocked[this.trophyCounter].alpha=.5,game.add.tween(this.trophyLocked[this.trophyCounter]).to({x:140+200*t},400,Phaser.Easing.Linear.Out,!0),this.trophyLockedText[this.trophyCounter]=game.add.text(865+200*t,200+60*e,this.trophyData.trophyNames[this.trophyCounter],{font:fonts,fill:textColor}),this.trophyLockedText[this.trophyCounter].anchor.setTo(0,.5),this.trophyLockedText[this.trophyCounter].alpha=.5,game.add.tween(this.trophyLockedText[this.trophyCounter]).to({x:165+200*t},400,Phaser.Easing.Linear.Out,!0),this.trophyCounter++;game.conf.enemyKillCounter>=30&&(this.trophyLocked[5].alpha=1,game.add.tween(this.trophyLocked[5]).to({angle:-10},300).to({angle:0},300).to({angle:10},300).to({angle:0},300).loop().start(),this.trophyLockedText[5].alpha=1),!0===game.conf.easyEnding&&(this.trophyLocked[0].alpha=1,game.add.tween(this.trophyLocked[0]).to({angle:-10},300).to({angle:0},300).to({angle:10},300).to({angle:0},300).loop().start(),this.trophyLockedText[0].alpha=1),!0===game.conf.casualEnding&&(this.trophyLocked[1].alpha=1,game.add.tween(this.trophyLocked[1]).to({angle:-10},300).to({angle:0},300).to({angle:10},300).to({angle:0},300).loop().start(),this.trophyLockedText[1].alpha=1),!0===game.conf.hardEnding&&(this.trophyLocked[2].alpha=1,game.add.tween(this.trophyLocked[2]).to({angle:-10},300).to({angle:0},300).to({angle:10},300).to({angle:0},300).loop().start(),this.trophyLockedText[2].alpha=1),game.input.onDown.add(this.menu,this)},update:function(){this.returnButton.input.pointerOver()?this.returnButton.alpha=1:this.returnButton.alpha=.5},toggleSound:function(){game.sound.mute=!game.sound.mute,this.muteButton.frame=game.sound.mute?1:0},stateMenu:function(){game.state.start("menu")},menu:function(){!this.muteButton.input.pointerOver()&&this.returnButton.input.pointerOver()&&this.transitionAnimation()},transitionAnimation:function(){game.add.tween(this.title).to({x:this.title.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.returnButton).to({x:this.returnButton.x-800},400,Phaser.Easing.Linear.Out,!0);for(var t=0,e=this.trophyCounter;t<e;t++)game.add.tween(this.trophyLocked[t]).to({x:this.trophyLocked[t].x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.trophyLockedText[t]).to({x:this.trophyLockedText[t].x-800},400,Phaser.Easing.Linear.Out,!0);game.time.events.add(500,this.stateMenu,this)},menuChoice:function(){this.muteButton.input.pointerOver()||this.returnButton.input.pointerOver()&&this.transitionAnimation("character")}},helpState={create:function(){game.stage.backgroundColor="#313131",this.title=game.add.text(1100,100,"Tutorial",{font:fontxl,fill:textColor}),game.add.tween(this.title).to({x:400},400,Phaser.Easing.Linear.Out,!0),this.title.anchor.set(.5),this.returnButton=game.add.text(1100,game.world.centerY+240,"Retour",{font:fontxl,fill:textColor}),game.add.tween(this.returnButton).to({x:400},400,Phaser.Easing.Linear.Out,!0),this.returnButton.anchor.set(.5),this.returnButton.alpha=.5,this.returnButton.inputEnabled=!0,this.muteButton=game.add.button(20,20,"mute",this.toggleSound,this),this.muteButton.input.useHandCursor=!0,game.sound.mute&&(this.muteButton.frame=1),this.coin=game.add.sprite(850,200,"coin"),game.add.tween(this.coin).to({x:150},400,Phaser.Easing.Linear.Out,!0),this.coin.anchor.setTo(.5,.5),this.coin.animations.add("turn",[0,1,2,3],8,!0),this.coin.animations.play("turn"),this.coin.scale.setTo(1,1),this.coinText=game.add.text(900,200,"Les pièces permettent de passer au niveau suivant",{font:fonts,fill:textColor}),game.add.tween(this.coinText).to({x:200},400,Phaser.Easing.Linear.Out,!0),this.coinText.anchor.setTo(0,.5),this.potion=game.add.sprite(850,275,"potion"),game.add.tween(this.potion).to({x:150},400,Phaser.Easing.Linear.Out,!0),this.potion.anchor.setTo(.5,.5),this.potion.scale.setTo(1,1),this.potionText=game.add.text(900,275,"Les potions vous font récupérer des points de vie",{font:fonts,fill:textColor}),game.add.tween(this.potionText).to({x:200},400,Phaser.Easing.Linear.Out,!0),this.potionText.anchor.setTo(0,.5),this.enemy1=game.add.sprite(850,350,"enemy"),game.add.tween(this.enemy1).to({x:150},400,Phaser.Easing.Linear.Out,!0),this.enemy1.anchor.setTo(.5,.5),this.enemy1.animations.add("walk",[7,6,5,6],8,!0),this.enemy1.animations.play("walk"),this.enemy1.scale.setTo(1,1),this.enemy1Text=game.add.text(900,350,"Ces ennemis ne peuvent pas être tués",{font:fonts,fill:textColor}),game.add.tween(this.enemy1Text).to({x:200},400,Phaser.Easing.Linear.Out,!0),this.enemy1Text.anchor.setTo(0,.5),this.enemy2=game.add.sprite(850,425,"enemy2"),game.add.tween(this.enemy2).to({x:150},400,Phaser.Easing.Linear.Out,!0),this.enemy2.anchor.setTo(.5,.5),this.enemy2.animations.add("walk",[7,6,5,6],8,!0),this.enemy2.animations.play("walk"),this.enemy2.scale.setTo(1,1),this.enemy2Text=game.add.text(900,425,"Ces ennemis peuvent être écrasés en sautant dessus",{font:fonts,fill:textColor}),game.add.tween(this.enemy2Text).to({x:200},400,Phaser.Easing.Linear.Out,!0),this.enemy2Text.anchor.setTo(0,.5),game.input.onDown.add(this.menu,this)},update:function(){this.returnButton.input.pointerOver()?this.returnButton.alpha=1:this.returnButton.alpha=.5},transitionAnimation:function(){game.add.tween(this.title).to({x:this.title.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.returnButton).to({x:this.returnButton.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.coin).to({x:this.coin.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.coinText).to({x:this.coin.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.potion).to({x:this.potion.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.potionText).to({x:this.coin.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.enemy1).to({x:this.enemy1.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.enemy1Text).to({x:this.enemy1Text.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.enemy2).to({x:this.enemy2.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.enemy2Text).to({x:this.enemy2Text.x-800},400,Phaser.Easing.Linear.Out,!0),game.time.events.add(500,this.stateMenu,this)},menu:function(){!this.muteButton.input.pointerOver()&&this.returnButton.input.pointerOver()&&this.transitionAnimation()},stateMenu:function(){game.state.start("menu")},toggleSound:function(){game.sound.mute=!game.sound.mute,this.muteButton.frame=game.sound.mute?1:0}},characterState={create:function(){this.choice=game.add.text(1100,100,"Choix du personnage",{font:fontxl,fill:textColor}),game.add.tween(this.choice).to({x:400},400,Phaser.Easing.Linear.Out,!0),this.choice.anchor.set(.5),this.returnButton=game.add.text(1100,game.world.centerY+240,"Retour",{font:fontxl,fill:textColor}),game.add.tween(this.returnButton).to({x:400},400,Phaser.Easing.Linear.Out,!0),this.returnButton.anchor.set(.5),this.returnButton.alpha=.5,this.returnButton.inputEnabled=!0,this.achilleName=game.add.text(400,game.world.centerY+160,"Achille",{font:fontxl,fill:textColor}),this.achilleName.anchor.set(.5),this.achilleName.alpha=0,this.ernestName=game.add.text(400,game.world.centerY+160,"Ernest",{font:fontxl,fill:textColor}),this.ernestName.anchor.set(.5),this.ernestName.alpha=0,this.achille=game.add.sprite(1025,game.world.centerY,"achilleimg"),game.add.tween(this.achille).to({x:325},400,Phaser.Easing.Linear.Out,!0),this.achille.anchor.set(.5),this.achille.alpha=.5,this.achille.inputEnabled=!0,this.achilleTween=game.add.tween(this.achille).to({angle:-5},200).to({angle:0},200).to({angle:5},200).to({angle:0},200).loop().start(),this.ernest=game.add.sprite(1175,game.world.centerY,"ernestimg"),game.add.tween(this.ernest).to({x:475},400,Phaser.Easing.Linear.Out,!0),this.ernest.anchor.set(.5),this.ernest.alpha=.5,this.ernest.inputEnabled=!0,this.ernestTween=game.add.tween(this.ernest).to({angle:-5},200).to({angle:0},200).to({angle:5},200).to({angle:0},200).loop().start(),this.muteButton=game.add.button(20,20,"mute",this.toggleSound,this),this.muteButton.input.useHandCursor=!0,game.sound.mute&&(this.muteButton.frame=1),game.input.onDown.add(this.characterChoice,this)},update:function(){this.achille.input.pointerOver()?(this.achille.alpha=1,this.achilleName.alpha=1,this.achilleTween.resume(),this.ernestTween.pause()):this.ernest.input.pointerOver()?(this.ernest.alpha=1,this.ernestName.alpha=1,this.ernestTween.resume(),this.achilleTween.pause()):this.returnButton.input.pointerOver()?this.returnButton.alpha=1:(this.achille.alpha=.5,this.ernest.alpha=.5,this.achilleName.alpha=0,this.ernestName.alpha=0,this.returnButton.alpha=.5,this.ernestTween.pause(),this.achilleTween.pause())},stateDifficulty:function(){game.state.start("difficulty")},stateMenu:function(){game.state.start("menu")},transitionAnimation:function(t){game.add.tween(this.choice).to({x:this.choice.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.achille).to({x:this.achille.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.ernest).to({x:this.ernest.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.returnButton).to({x:this.returnButton.x-800},400,Phaser.Easing.Linear.Out,!0),this.achilleName.kill(),this.ernestName.kill(),"difficulty"===t?game.time.events.add(500,this.stateDifficulty,this):"menu"===t&&game.time.events.add(500,this.stateMenu,this)},toggleSound:function(){game.sound.mute=!game.sound.mute,this.muteButton.frame=game.sound.mute?1:0},characterChoice:function(){this.achille.input.pointerOver()?(game.character="achille",this.transitionAnimation("difficulty")):this.ernest.input.pointerOver()?(game.character="ernest",this.transitionAnimation("difficulty")):this.returnButton.input.pointerOver()&&this.transitionAnimation("menu")}},difficultyState={create:function(){this.choiceDifficulty=game.add.text(1100,100,"Difficulté",{font:fontxl,fill:textColor}),game.add.tween(this.choiceDifficulty).to({x:400},400,Phaser.Easing.Linear.Out,!0),this.choiceDifficulty.anchor.set(.5),this.returnButton=game.add.text(1100,game.world.centerY+240,"Retour",{font:fontxl,fill:textColor}),game.add.tween(this.returnButton).to({x:400},400,Phaser.Easing.Linear.Out,!0),this.returnButton.anchor.set(.5),this.returnButton.alpha=.5,this.returnButton.inputEnabled=!0,this.easyDifficulty=game.add.text(1100,game.world.centerY-100,"Facile",{font:fontxl,fill:textColor}),game.add.tween(this.easyDifficulty).to({x:400},400,Phaser.Easing.Linear.Out,!0),this.easyDifficulty.anchor.set(.5),this.easyDifficulty.alpha=.5,this.easyDifficulty.inputEnabled=!0,this.casualDifficulty=game.add.text(1100,game.world.centerY,"Normal",{font:fontxl,fill:textColor}),game.add.tween(this.casualDifficulty).to({x:400},400,Phaser.Easing.Linear.Out,!0),this.casualDifficulty.anchor.set(.5),this.casualDifficulty.alpha=.5,this.casualDifficulty.inputEnabled=!0,this.hardDifficulty=game.add.text(1100,game.world.centerY+100,"Difficile",{font:fontxl,fill:textColor}),game.add.tween(this.hardDifficulty).to({x:400},400,Phaser.Easing.Linear.Out,!0),this.hardDifficulty.anchor.set(.5),this.hardDifficulty.alpha=.5,this.hardDifficulty.inputEnabled=!0,this.muteButton=game.add.button(20,20,"mute",this.toggleSound,this),this.muteButton.input.useHandCursor=!0,game.sound.mute&&(this.muteButton.frame=1),game.input.onDown.add(this.difficultyChoice,this)},update:function(){this.easyDifficulty.input.pointerOver()?this.easyDifficulty.alpha=1:this.casualDifficulty.input.pointerOver()?this.casualDifficulty.alpha=1:this.hardDifficulty.input.pointerOver()?this.hardDifficulty.alpha=1:this.returnButton.input.pointerOver()?this.returnButton.alpha=1:(this.easyDifficulty.alpha=.5,this.casualDifficulty.alpha=.5,this.hardDifficulty.alpha=.5)},toggleSound:function(){game.sound.mute=!game.sound.mute,this.muteButton.frame=game.sound.mute?1:0},difficultyChoice:function(){this.easyDifficulty.input.pointerOver()?(game.conf.difficulty="easy",this.transitionAnimation("play")):this.casualDifficulty.input.pointerOver()?(game.conf.difficulty="casual",this.transitionAnimation("play")):this.hardDifficulty.input.pointerOver()?(game.conf.difficulty="hard",this.transitionAnimation("play")):this.returnButton.input.pointerOver()&&this.transitionAnimation("character")},transitionAnimation:function(t){game.add.tween(this.choiceDifficulty).to({x:this.choiceDifficulty.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.easyDifficulty).to({x:this.easyDifficulty.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.casualDifficulty).to({x:this.casualDifficulty.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.hardDifficulty).to({x:this.hardDifficulty.x-800},400,Phaser.Easing.Linear.Out,!0),game.add.tween(this.returnButton).to({x:this.returnButton.x-800},400,Phaser.Easing.Linear.Out,!0),"play"===t?game.time.events.add(500,this.stateLevel,this):"character"===t&&game.time.events.add(500,this.stateCharacter,this)},stateLevel:function(){game.state.start("level",!0,!1,1)},stateCharacter:function(){game.state.start("character")}},levelState={init:function(t){switch(game.conf.mapName=t,game.conf.difficulty){case"easy":game.conf.difficultyData=JSON.parse(this.game.cache.getText("easy"));break;case"hard":game.conf.difficultyData=JSON.parse(this.game.cache.getText("hard"));break;default:game.conf.difficultyData=JSON.parse(this.game.cache.getText("casual"))}},create:function(){game.stage.backgroundColor="#000000",game.time.events.add(400,this.displayText,this),game.time.events.add(1600,this.eraseText,this),game.time.events.add(2400,this.statePlay,this)},displayText:function(){switch(this.level=game.add.text(400,game.world.centerY-75,"World 1 - "+game.conf.mapName,{font:fontxl,fill:textColor}),this.level.anchor.set(.5),this.level.alpha=0,game.add.tween(this.level).to({alpha:1},400,"Linear",!0),game.conf.mapName){case 1:case 2:this.tutoLabel=game.add.text(400,game.world.centerY+75,"Goal : "+game.conf.difficultyData.score+" points",{font:fontl,fill:textColor});break;case 3:this.tutoLabel=game.add.text(400,game.world.centerY+75,"Goal : Defeat the Boss",{font:fontl,fill:textColor});break;case 4:this.tutoLabel=game.add.text(400,game.world.centerY+75,"Goal : Collect all coins",{font:fontl,fill:textColor})}this.tutoLabel.anchor.set(.5),this.tutoLabel.alpha=0,game.add.tween(this.tutoLabel).to({alpha:1},400,"Linear",!0)},eraseText:function(){game.add.tween(this.level).to({alpha:0},400,"Linear",!0),game.add.tween(this.tutoLabel).to({alpha:0},400,"Linear",!0)},statePlay:function(){game.state.start("play",!0,!1,game.conf.mapName)}},playState={init:function(t){switch(t){case 2:this.levelData=JSON.parse(this.game.cache.getText("level2"));break;case 3:this.levelData=JSON.parse(this.game.cache.getText("level3"));break;case 4:this.levelData=JSON.parse(this.game.cache.getText("level4"));break;default:this.levelData=JSON.parse(this.game.cache.getText("level1"))}4===game.conf.mapName&&(game.conf.difficultyData.score=100)},create:function(){game.conf.mapName<=3?game.stage.backgroundColor=game.add.tileSprite(0,0,800,640,"background"):4===game.conf.mapName&&(game.stage.backgroundColor=game.add.tileSprite(0,0,3840,640,"backgroundscroll")),this.cursor=game.input.keyboard.createCursorKeys(),game.input.keyboard.addKeyCapture([Phaser.Keyboard.UP,Phaser.Keyboard.DOWN,Phaser.Keyboard.LEFT,Phaser.Keyboard.RIGHT]),this.space=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.zsqd={up:game.input.keyboard.addKey(Phaser.Keyboard.Z),down:game.input.keyboard.addKey(Phaser.Keyboard.S),left:game.input.keyboard.addKey(Phaser.Keyboard.Q),right:game.input.keyboard.addKey(Phaser.Keyboard.D)},this.createWorld(),"achille"===game.character?this.player=game.add.sprite(this.levelData.playerStart.x,this.levelData.playerStart.y,"achille"):"ernest"===game.character&&(this.player=game.add.sprite(this.levelData.playerStart.x,this.levelData.playerStart.y,"ernest")),game.camera.follow(this.player),this.player.anchor.setTo(.5,.5),game.physics.arcade.enable(this.player),this.player.body.gravity.y=1e3,this.player.animations.add("right",[1,2,3,2],8,!0),this.player.animations.add("left",[5,6,7,6],8,!0),this.player.animations.add("jump-right",[8],8,!0),this.player.animations.add("down-right",[9],8,!0),this.player.animations.add("jump-left",[10],8,!0),this.player.animations.add("down-left",[11],8,!0),this.life_points=3,this.direction="right",this.player.body.checkCollision.up=!1,this.player.body.setSize(30,36,5,0),this.health=game.add.sprite(625,20,"health"),this.health.fixedToCamera=!0,this.health.animations.add("5",[0],1,!0),this.health.animations.add("4",[1],1,!0),this.health.animations.add("3",[2],1,!0),this.health.animations.add("2",[3],1,!0),this.health.animations.add("1",[4],1,!0),this.health.animations.add("0",[5],1,!0),this.health.animations.play(this.life_points),3===game.conf.mapName&&(this.boss=game.add.sprite(this.levelData.bossStart.x,this.levelData.bossStart.y,"boss"),game.physics.arcade.enable(this.boss),this.boss.anchor.setTo(.5,.5),this.boss.animations.add("walk",[0,1],8,!0),this.boss.animations.play("walk"),this.boss.animations.add("hurtAnim",[2,3,4,3,2],10,!0),this.boss.body.gravity.y=1e3,this.boss.body.velocity.x=-100,this.boss.body.bounce.x=1,this.boss.direction="left",this.boss.body.setSize(56,56,0,18),this.boss_life_points=5,this.healthBoss=game.add.sprite(this.levelData.bossHealth.x,this.levelData.bossHealth.y,"healthBoss"),this.healthBoss.anchor.setTo(.5,.5),this.healthBoss.animations.add("5",[0],1,!0),this.healthBoss.animations.add("4",[1],1,!0),this.healthBoss.animations.add("3",[2],1,!0),this.healthBoss.animations.add("2",[3],1,!0),this.healthBoss.animations.add("1",[4],1,!0),this.healthBoss.animations.add("0",[5],1,!0),this.healthBoss.animations.play(this.boss_life_points),this.timer_missile=game.time.events.loop(1.5*Phaser.Timer.SECOND,this.fireMissile,this)),this.missiles=game.add.group(),this.missiles.enableBody=!0,this.missiles.createMultiple(10,"missile"),this.missiles.callAll("events.onOutOfBounds.add","events.onOutOfBounds",this.resetMissile),this.missiles.callAll("anchor.setTo","anchor",.5,1),this.missiles.setAll("checkWorldBounds",!0),this.coin=game.add.sprite(this.levelData.coinStart.x,this.levelData.coinStart.y,"coin"),game.physics.arcade.enable(this.coin),this.coin.anchor.setTo(.5,.5),this.coin.animations.add("turn",[0,1,2,3],8,!0),this.coin.animations.play("turn"),this.coin.scale.setTo(1,1),this.coinCount=0,this.life_points<=3&&(this.potion=game.add.sprite(this.levelData.potionStart.x,this.levelData.potionStart.y,"potion")),game.physics.arcade.enable(this.potion),this.potion.anchor.setTo(.5,.5),this.scoreLabel=game.add.text(65,17,"Score : 0 / "+game.conf.difficultyData.score,{font:fontm,fill:textColor}),this.scoreLabel.setShadow(3,3,"rgba(0,0,0,0.5)",5),this.scoreLabel.fixedToCamera=!0,this.score=0,3===game.conf.mapName&&(this.boss_life_pointsLabel=game.add.text(400,170,"Boss",{font:fontxl,fill:textColor}),this.boss_life_pointsLabel.anchor.setTo(.5,.5),this.boss_life_pointsLabel.setShadow(3,3,"rgba(0,0,0,0.5)",5)),this.enemies=game.add.group(),this.enemies.enableBody=!0;for(var t=0;t<12;t++)switch(game.rnd.integerInRange(0,3)){case 0:case 1:this.enemies.createMultiple(1,"enemy");break;case 2:case 3:this.enemies.createMultiple(1,"enemy2")}this.nextEnemy=0,this.enemies.callAll("animations.add","animations","walk-left",[0,1,2,1],10),this.enemies.callAll("animations.add","animations","walk-right",[7,6,5,6],10),this.enemies.callAll("animations.add","animations","fall-left",[3],10),this.enemies.callAll("animations.add","animations","fall-right",[4],10),this.jumpSound=game.add.audio("jump"),this.coinSound=game.add.audio("coin"),this.hurtSound=game.add.audio("hurtSound"),this.deadSound=game.add.audio("dead"),this.potionSound=game.add.audio("potion"),this.missileSound=game.add.audio("boom"),this.missileSound.volume=.3,this.bossDieSound=game.add.audio("bossDieSound"),this.bossDieSound.volume=.5,this.bossHurtSound=game.add.audio("bossHurtSound"),this.enemyDieSound=game.add.audio("enemyDieSound"),this.enemyDieSound.volume=.4,this.muteButton=game.add.button(20,20,"mute",this.toggleSound,this),this.muteButton.input.useHandCursor=!0,this.muteButton.fixedToCamera=!0,this.trophySound=game.add.audio("trophy"),game.sound.mute&&(this.muteButton.frame=1),this.emitter=game.add.emitter(0,0,15),this.emitter.makeParticles("pixel"),this.emitter.setYSpeed(-200,200),this.emitter.setXSpeed(-200,200),this.emitter.gravity=0,this.emitter.minParticleScale=.5,this.emitter.minRotation=50,this.createWorldForeground(),game.stage.backgroundColor="#3c906e",this.executed=!1,this.hurtAgain=!0,this.addMobileInputs()},update:function(){if(game.physics.arcade.collide(this.player,this.layer),game.physics.arcade.collide(this.enemies,this.layer),game.physics.arcade.collide(this.boss,this.layer),game.physics.arcade.collide(this.player,this.movingWall),game.physics.arcade.overlap(this.player,this.coin,this.takeCoin,null,this),game.physics.arcade.overlap(this.player,this.potion,this.takePotion,null,this),game.physics.arcade.overlap(this.player,this.enemies,this.enemyOrPlayerHurt,null,this),game.physics.arcade.overlap(this.player,this.missiles,this.playerHurt,null,this),game.physics.arcade.overlap(this.player,this.boss,this.bossOrPlayerHurt,null,this),this.movePlayer(),this.moveBoss(),!this.player.inWorld&&this.player.body.y>0&&this.score<game.conf.difficultyData.score&&this.playerDie(),this.nextEnemy<game.time.now){var t=game.conf.difficultyData.score,e=Math.max(4e3-3e3*this.score/t,1e3);game.conf.mapName<3&&(game.time.events.add(3e3,this.addEnemy,this),this.nextEnemy=game.time.now+e)}this.enemies.forEach(this.animateEnemy),1===game.conf.mapName&&(this.movingWall.x>=this.levelData.movingwallStart.x+50?this.movingWall.body.velocity.x=-50:this.movingWall.x<=this.levelData.movingwallStart.x-50&&(this.movingWall.body.velocity.x=50)),0===this.life_points&&this.playerDie()},createWorld:function(){this.map=game.add.tilemap(game.conf.mapName),this.map.addTilesetImage("tileset"),this.layer=this.map.createLayer("Tile Layer 1"),4===game.conf.mapName&&this.layer.resizeWorld(),this.map.setCollisionBetween(1,14),1===game.conf.mapName&&(this.movingWall=game.add.sprite(this.levelData.movingwallStart.x,this.levelData.movingwallStart.y,"wallH"),this.movingWall.anchor.setTo(.5,1),game.physics.arcade.enable(this.movingWall),this.movingWall.enableBody=!0,this.movingWall.body.immovable=!0,this.movingWall.body.velocity.x=50)},createWorldForeground:function(){this.layer2=this.map.createLayer("Tile Layer 2"),4===game.conf.mapName&&this.layer2.resizeWorld()},movePlayer:function(){this.cursor.left.isDown||this.zsqd.left.isDown||this.moveLeft?(this.player.body.velocity.x=-200,this.player.animations.play("left"),this.direction="left"):this.cursor.right.isDown||this.zsqd.right.isDown||this.moveRight?(this.player.body.velocity.x=200,this.player.animations.play("right"),this.direction="right"):(this.player.body.velocity.x=0,this.player.animations.stop(),"left"===this.direction?this.player.frame=4:this.player.frame=0),(this.cursor.up.isDown||this.space.isDown||this.zsqd.up.isDown)&&this.playerJump(),(this.cursor.up.isDown&&"right"===this.direction||!this.player.body.onFloor()&&"right"===this.direction&&0!==this.player.body.velocity.y)&&(this.player.animations.play("jump-right"),this.player.body.velocity.y>0&&1===this.player.scale.y?this.player.animations.play("down-right"):0===this.player.body.velocity.y&&0===this.player.body.velocity.x&&(this.player.frame=0)),(this.cursor.up.isDown&&"left"===this.direction||!this.player.body.onFloor()&&"left"===this.direction&&0!==this.player.body.velocity.y)&&(this.player.animations.play("jump-left"),this.player.body.velocity.y>0&&1===this.player.scale.y?this.player.animations.play("down-left"):0===this.player.body.velocity.y&&0===this.player.body.velocity.x&&(this.player.frame=4))},playerJump:function(){(0===this.player.body.velocity.y||this.player.body.onFloor())&&this.player.alive&&(this.player.body.velocity.y=-470,this.jumpSound.play())},playerHurt:function(t,e){!this.executed&&this.life_points>=1&&this.score<game.conf.difficultyData.score&&(this.executed=!0,this.life_points-=1,this.health.animations.play(this.life_points),this.player.alpha=.5,this.player.tint=16777215,this.tint=game.time.events.loop(100,this.changeTint,this),game.time.events.add(990,this.resetTint,this),game.time.events.add(1e3,this.reset_executed,this),this.life_points>=4&&"hard"!==game.conf.difficulty&&game.time.events.add(game.conf.difficultyData.potionTime,this.updatePotionPosition,this),this.life_points>=1&&this.hurtSound.play())},changeTint:function(){this.player.tint=16711680===this.player.tint?16777215:16711680},resetTint:function(){game.time.events.remove(this.tint),this.player.tint=16777215},reset_executed:function(){this.executed=!1,this.player.alpha=1,this.player.tint=16777215,3===game.conf.mapName&&(this.boss.body.enable=!0,this.boss.animations.play("walk"))},playerDie:function(){if(this.player.alive){this.player.kill(),this.deadSound.play();var t=game.add.text(400,game.world.centerY,"T'es nul...",{font:fontl,fill:textColor});t.fixedToCamera=!0,t.anchor.setTo(.5,.5),t.setShadow(3,3,"rgba(0,0,0,0.5)",5),game.stage.backgroundColor="#313131",this.emitter.x=this.player.x,this.emitter.y=this.player.y,this.emitter.start(!0,600,null,6),game.time.events.add(1e3,this.restartLevel,this)}},moveBoss:function(){3===game.conf.mapName&&(this.boss.body.velocity.x>0&&"left"===this.boss.direction?(this.boss.scale.x=-1,this.boss.direction="right"):this.boss.body.velocity.x<0&&"right"===this.boss.direction&&(this.boss.scale.x=1,this.boss.direction="left"))},bossHurt:function(){!this.executed&&this.boss_life_points>=0&&(this.boss_life_points-=1,game.time.events.add(1e3,this.reset_executed,this),this.player.body.velocity.y=-200,this.boss.body.enable=!1,this.emitter.x=this.boss.x,this.emitter.y=this.boss.y,this.emitter.start(!0,300,null,6),this.boss.animations.play("hurtAnim"),this.healthBoss.animations.play(this.boss_life_points),this.boss_life_points>=1&&(game.time.events.add(Phaser.Timer.SECOND/4,this.fireMissileUp,this),this.bossHurtSound.play()),0===this.boss_life_points&&this.bossDie())},bossOrPlayerHurt:function(t,e){this.player.body.velocity.y<=0?this.playerHurt(t,e):this.player.body.velocity.y>0&&this.bossHurt()},bossDie:function(){this.bossDieSound.play(),this.boss.kill(),this.boss_life_pointsLabel.kill(),this.healthBoss.kill(),game.time.events.remove(this.timer_missile),this.nextLevelText()},fireMissile:function(){var t=this.missiles.getFirstDead();t&&this.boss.x>this.player.x?(t.reset(this.boss.x-30,this.boss.y+20),t.body.velocity.x=-500,t.scale.x=1,t.angle=0,this.missileSound.play()):t&&this.boss.x<=this.player.x&&(t.scale.x=-1,t.angle=0,t.reset(this.boss.x+30,this.boss.y+20),t.body.velocity.x=500,this.missileSound.play())},fireMissileUp:function(){var t=this.missiles.getFirstDead();t.reset(this.boss.x,this.boss.y),t.body.velocity.y=-500,this.missileSound.play(),1===t.scale.x?t.angle=90:t.angle=-90},resetMissile:function(t){t.kill()},addEnemy:function(){var t=this.enemies.getFirstDead();if(t){switch(t.anchor.setTo(.5,.5),t.reset(game.world.centerX,0),t.body.gravity.y=500,t.body.checkCollision.down=!0,t.body.checkCollision.left=!0,t.body.checkCollision.right=!0,t.body.checkCollision.up=!0,t.angle=0,game.rnd.integerInRange(0,3)){case 0:case 1:t.body.velocity.x=110;break;case 2:case 3:t.body.velocity.x=-110;break;default:t.body.velocity.x=110}t.body.bounce.x=1,t.checkWorldBounds=!0,t.outOfBoundsKill=!0}},animateEnemy:function(t){!t.body.onFloor()&&t.body.velocity.x<=0?t.animations.play("fall-left"):!t.body.onFloor()&&t.body.velocity.x>=0&&t.animations.play("fall-right"),t.body.onFloor()&&t.body.velocity.x<0?t.animations.play("walk-left"):t.body.onFloor()&&t.body.velocity.x>0&&t.animations.play("walk-right")},enemyOrPlayerHurt:function(t,e){!0===this.hurtAgain&&(t.body.velocity.y<=0||t.body.y>=e.body.y?(this.playerHurt(t,e),this.hurtAgain=!1,game.time.events.add(500,this.resetHurtAgain,this)):"enemy2"===e.key&&t.body.velocity.y>0&&(e.body.checkCollision.down=!1,e.body.checkCollision.left=!1,e.body.checkCollision.right=!1,e.body.checkCollision.up=!1,e.body.velocity.x<=0?game.add.tween(e).to({angle:-180},750,Phaser.Easing.Linear.Out,!0):e.body.velocity.x>0&&game.add.tween(e).to({angle:180},750,Phaser.Easing.Linear.Out,!0),this.enemyDieSound.play(),t.body.velocity.y=-200,e.body.velocity.y=-100,this.emitter.x=e.x,this.emitter.y=e.y,this.emitter.start(!0,300,null,6),this.hurtAgain=!1,game.time.events.add(500,this.resetHurtAgain,this),game.conf.enemyKillCounter++,30===game.conf.enemyKillCounter&&game.time.events.add(300,this.getTrophy,this,"Dexter Morgan")))},getTrophy:function(t){this.trophySound.play(),this.dialogue=game.add.sprite(game.world.width-400,-70,"dialogue"),this.dialogue.anchor.setTo(.5,.5),game.add.tween(this.dialogue).to({y:140},400,Phaser.Easing.Circular.Out,!0),this.trophyUnlocked=game.add.sprite(game.world.width-550,-70,"trophy"),this.trophyUnlocked.anchor.setTo(.5,.5),this.trophyUnlocked.scale.setTo(.5,.5),game.add.tween(this.trophyUnlocked).to({y:140},400,Phaser.Easing.Circular.Out,!0),this.trophyUnlockedText=game.add.text(game.world.width-400,-70,"Obtenu : "+t,{font:fonts,fill:textColorBlack}),this.trophyUnlockedText.anchor.setTo(.5,.5),game.add.tween(this.trophyUnlockedText).to({y:140},400,Phaser.Easing.Circular.Out,!0),game.time.events.add(2e3,this.eraseTrophy,this)},eraseTrophy:function(){game.add.tween(this.dialogue).to({y:-70},400,Phaser.Easing.Circular.In,!0),game.add.tween(this.trophyUnlocked).to({y:-70},400,Phaser.Easing.Circular.In,!0),game.add.tween(this.trophyUnlockedText).to({y:-70},400,Phaser.Easing.Circular.In,!0),game.time.events.add(500,this.killTrophy,this)},killTrophy:function(){this.dialogue.kill(),this.trophyUnlocked.kill(),this.trophyUnlockedText.kill()},resetHurtAgain:function(){this.hurtAgain=!0},takeCoin:function(){this.pointsLabel=game.add.text(this.coin.x,this.coin.y,"10",{font:fontm,fill:textColor}),this.pointsLabel.anchor.setTo(.5,.5),this.pointsLabel.setShadow(3,3,"rgba(0,0,0,0.5)",5),game.time.events.add(500,this.eraseScore,this),game.add.tween(this.pointsLabel).to({y:this.coin.y-50},500,"Linear",!0),this.score<game.conf.difficultyData.score-10?this.updateCoinPosition():(this.coin.kill(),this.potion.kill()),this.score+=10,this.scoreLabel.text="Score : "+this.score+" / "+game.conf.difficultyData.score,this.coinSound.play(),this.coin.scale.setTo(0,0),game.add.tween(this.coin.scale).to({x:1,y:1},300).start(),game.add.tween(this.player.scale).to({x:1.2,y:.8},50).to({x:1,y:1},150).start(),this.score===game.conf.difficultyData.score&&this.nextLevelText()},eraseScore:function(){game.add.tween(this.pointsLabel).to({alpha:0},500,"Linear",!0)},updateCoinPosition:function(){for(var t=this.levelData.coinPosition.slice(0),e=void 0,a=0;a<t.length;a++)game.conf.mapName<4&&t[a].x===this.coin.x&&t[a].y===this.coin.y&&(t.splice(a,1),t.splice(0,t[a]));game.conf.mapName<4?e=t[game.rnd.integerInRange(0,t.length-1)]:4===game.conf.mapName&&this.coinCount<9&&(e=t[this.coinCount+=1]),this.coin.reset(e.x,e.y)},takePotion:function(){this.healthBonus=game.add.sprite(this.potion.x,this.potion.y,"healthBonus"),this.healthBonus.anchor.setTo(.5,.5),game.time.events.add(500,this.eraseHealthBonus,this),game.add.tween(this.healthBonus).to({y:this.potion.y-50},500,"Linear",!0),game.add.tween(this.player.scale).to({x:.8,y:1.2},50).to({x:1,y:1},150).start(),this.updatePotionPosition(),this.life_points+=1,this.health.animations.play(this.life_points),this.potionSound.play();var t={x:-100,y:-100};this.potion.reset(t.x,t.y),this.life_points<=4&&"hard"!==game.conf.difficulty&&game.time.events.add(game.conf.difficultyData.potionTime,this.updatePotionPosition,this)},eraseHealthBonus:function(){game.add.tween(this.healthBonus).to({alpha:0},500,"Linear",!0)},updatePotionPosition:function(){for(var t=this.levelData.potionPosition.slice(0),e=0;e<t.length;e++)t[e].x===this.potion.x&&t.splice(e,1);var a=t[game.rnd.integerInRange(0,t.length-1)];this.potion.reset(a.x,a.y)},addMobileInputs:function(){this.jumpButton=game.add.sprite(650,620,"jumpButton"),this.jumpButton.inputEnabled=!0,this.jumpButton.alpha=.5,this.jumpButton.events.onInputDown.add(function(){this.playerJump()},this),this.moveLeft=!1,this.moveRight=!1,this.leftButton=game.add.sprite(50,620,"leftButton"),this.leftButton.inputEnabled=!0,this.leftButton.alpha=.5,this.leftButton.events.onInputOver.add(function(){this.moveLeft=!0},this),this.leftButton.events.onInputOut.add(function(){this.moveLeft=!1},this),this.leftButton.events.onInputDown.add(function(){this.moveLeft=!0},this),this.leftButton.events.onInputUp.add(function(){this.moveLeft=!1},this),this.rightButton=game.add.sprite(350,620,"rightButton"),this.rightButton.inputEnabled=!0,this.rightButton.alpha=.5,this.rightButton.events.onInputOver.add(function(){this.moveRight=!0},this),this.rightButton.events.onInputOut.add(function(){this.moveRight=!1},this),this.rightButton.events.onInputDown.add(function(){this.moveRight=!0},this),this.rightButton.events.onInputUp.add(function(){this.moveRight=!1},this)},startMenu:function(){game.state.start("menu")},nextLevelText:function(){var t=void 0;game.conf.mapName<=3?((t=game.add.text(game.world.centerX,game.world.centerY,"Niveau terminé",{font:fontl,fill:textColor})).anchor.setTo(.5,.5),t.setShadow(3,3,"rgba(0,0,0,0.5)",5),game.time.events.add(3e3,this.nextLevelState,this)):4===game.conf.mapName&&((t=game.add.text(400,game.world.centerY,"Jeu terminé ! Bravo !",{font:fontl,fill:textColor})).fixedToCamera=!0,t.anchor.setTo(.5,.5),t.setShadow(3,3,"rgba(0,0,0,0.5)",5),"easy"===game.conf.difficulty?(game.conf.easyEnding=!0,game.time.events.add(300,this.getTrophy,this,"Fin Facile")):"casual"===game.conf.difficulty?(game.conf.casualEnding=!0,game.time.events.add(300,this.getTrophy,this,"Fin Normale")):"hard"===game.conf.difficulty&&(game.conf.hardEnding=!0,game.time.events.add(300,this.getTrophy,this,"Fin Difficile")),game.time.events.add(3e3,this.startMenu,this))},nextLevelState:function(){game.state.start("level",!0,!1,game.conf.mapName+1)},restartLevel:function(){"hard"!==game.conf.difficulty?game.state.start("level",!0,!1,game.conf.mapName):game.state.start("level",!0,!1,1)},toggleSound:function(){game.sound.mute=!game.sound.mute,this.muteButton.frame=game.sound.mute?1:0}};if(window.innerWidth<=800)var canvasHeight=700,antialias=!0;else var canvasHeight=640,antialias=!1;var game=new Phaser.Game(800,window.canvasHeight,Phaser.AUTO,"gameDiv",null,!1,window.antialias),textColor="#ffffff",textColorBlack="#000000",textFont="VT323",fontxl="50px "+textFont,fontl="30px "+textFont,fontm="25px "+textFont,fonts="20px "+textFont,WebFontConfig={google:{families:["VT323"]}};game.global={score:0},game.conf={},game.state.add("boot",bootState),game.state.add("load",loadState),game.state.add("menu",menuState),game.state.add("trophy",trophyState),game.state.add("help",helpState),game.state.add("character",characterState),game.state.add("difficulty",difficultyState),game.state.add("level",levelState),game.state.add("play",playState),game.state.start("boot");